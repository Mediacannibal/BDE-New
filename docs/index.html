<!DOCTYPE html><html lang="en"><head><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-157352486-1"></script><script>window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'UA-157352486-1');</script><title>MC BDE</title><meta name="google-site-verification" content="wXopyExZq8koLZmUF4Luqcvwb95AK20FLi3-lBJFkJ0"><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Square Dashboard: React Single Page Application"><script src="https://apis.google.com/js/client:platform.js"></script><script src="https://www.gstatic.com/firebasejs/ui/4.8.0/firebase-ui-auth.js"></script><link type="text/css" rel="stylesheet" href="https://www.gstatic.com/firebasejs/ui/4.8.0/firebase-ui-auth.css"><link rel="manifest" href="/manifest.json"><link rel="shortcut icon" href="./logo.svg"></head><style>body {
        font-family: Barlow;
    }</style><body><div id="root"></div><div id="modal"></div><script>!function (e, a, t, n, g, c, o) { e.GoogleAnalyticsObject = g, e.ga = e.ga || function () { (e.ga.q = e.ga.q || []).push(arguments) }, e.ga.l = 1 * new Date, c = a.createElement(t), o = a.getElementsByTagName(t)[0], c.async = 1, c.src = "https://www.google-analytics.com/analytics.js", o.parentNode.insertBefore(c, o) }(window, document, "script", 0, "ga"), ga("create", "UA-37045209-2", "auto"), ga("send", "pageview")</script><script type="text/javascript" src="./app~748942c6.c067c16ba48244e4a009.js"></script><script type="text/javascript" src="./app~253ae210.c067c16ba48244e4a009.js"></script><script type="text/javascript" src="./app~d939e436.c067c16ba48244e4a009.js"></script><script type="text/javascript" src="./app~987e6011.c067c16ba48244e4a009.js"></script><script type="text/javascript" src="./app~93acefaf.c067c16ba48244e4a009.js"></script><script type="text/javascript" src="./app~2e7d8596.c067c16ba48244e4a009.js"></script><script type="text/javascript" src="./app~1f20a385.c067c16ba48244e4a009.js"></script><script type="text/javascript" src="./app~c1dd23ef.c067c16ba48244e4a009.js"></script><script type="text/javascript" src="./app~678f84af.c067c16ba48244e4a009.js"></script><script type="text/javascript" src="./app~aacb323a.c067c16ba48244e4a009.js"></script></body><!-- The core Firebase JS SDK is always required and must be listed first --><script src="https://www.gstatic.com/firebasejs/8.6.2/firebase-app.js"></script><script src="https://www.gstatic.com/firebasejs/8.6.2/firebase-messaging.js"></script><!-- TODO: Add SDKs for Firebase products that you want to use
     https://firebase.google.com/docs/web/setup#available-libraries --><script src="https://www.gstatic.com/firebasejs/8.6.2/firebase-analytics.js"></script><!-- <script>
    function showToken(a) {
        console.log(a);
    }
    firebase.initializeApp({
        apiKey: "AIzaSyBROSFdFQWbp8K2xMMjKaqazC4HP4grI5A",
        authDomain: "mc-bde.firebaseapp.com",
        projectId: "mc-bde",
        storageBucket: "mc-bde.appspot.com",
        messagingSenderId: "181659839939",
        appId: "1:181659839939:web:bd1bd39cb9b2232add6176",
        measurementId: "G-R7GER30TG2"
    });

    const messaging = firebase.messaging();

    // messaging.usePublicVapidKey()

    function subscribe(messaging) {
        messaging.requestPermission()
            .then(function () {
                messaging.getToken()
                    .then(function (currentToken) {
                        console.log(currentToken);

                        if (currentToken) {
                            sendTokenToServer(currentToken);
                        }
                    })
                    .catch(function (err) {
                        setTokenSentToServer(false);
                    });
            })
            .catch(function (err) {
                console.warn('not granted', err);
            });
    }

    function sendTokenToServer(currentToken) {
        if (!isTokenSentToServer(currentToken)) {
            console.log('Отправка токена на сервер...');

            var url = '';
            $.post(url, {
                token: currentToken
            });

            setTokenSentToServer(currentToken);
        }
    }

    function isTokenSentToServer(currentToken) {
        return window.localStorage.getItem('sentFirebaseMessagingToken') == currentToken;
    }

    function setTokenSentToServer(currentToken) {
        window.localStorage.setItem(
            'sentFirebaseMessagingToken',
            currentToken ? currentToken : ''
        );
    }


    if ('Notification' in window) {
        navigator.serviceWorker.register("./firebase-messaging-sw.js")
            .then((registration) => {
                var messaging = firebase.messaging();
                messaging.useServiceWorker(registration);
                console.log(messaging);
                if (Notification.permission === 'granted') {
                    subscribe(messaging);
                    messaging.onMessage(function (payload) {
                        console.log('Message received. ', payload);
                    });
                }

                $('#subscribe').on('click', function () {
                    subscribe(messaging);
                });
            });

    }

</script> --></html>